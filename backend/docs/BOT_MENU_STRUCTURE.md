# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ–Ω—é —á–∞—Ç-–±–æ—Ç–∞ UniFlow

## –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –±–æ—Ç–∞ –∏–º–µ–µ—Ç 4 —Å—Ç—Ä–æ–∫–∏ –∫–Ω–æ–ø–æ–∫:

### –°—Ç—Ä–æ–∫–∞ 1: –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ
- **üìÖ –°–µ–≥–æ–¥–Ω—è** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å
- **üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π –ø–æ –¥–Ω—è–º

### –°—Ç—Ä–æ–∫–∞ 2: –°–ø–∏—Å–∫–∏
- **üìÅ –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **üì• –í—Ö–æ–¥—è—â–∏–µ** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### –°—Ç—Ä–æ–∫–∞ 3: –°–æ–∑–¥–∞–Ω–∏–µ
- **‚ûï –ù–æ–≤–∞—è –∑–∞–¥–∞—á–∞** - –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ (4 —à–∞–≥–∞)
- **üìÇ –ù–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç** - –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (2 —à–∞–≥–∞)

### –°—Ç—Ä–æ–∫–∞ 4: –ü–æ–∏—Å–∫
- **üîç –ü–æ–∏—Å–∫** - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ (–∑–∞–Ω–∏–º–∞–µ—Ç –≤—Å—é —Å—Ç—Ä–æ–∫—É)

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ (Schedule)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É
- –ù–∞–≤–∏–≥–∞—Ü–∏—è: ‚Üê –ù–∞–∑–∞–¥ | –°–µ–≥–æ–¥–Ω—è | –í–ø–µ—Ä–µ–¥ ‚Üí
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å—É: –∞–∫—Ç–∏–≤–Ω—ã–µ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ
- Callback format: `menu_schedule_{offset}` –≥–¥–µ offset - —Å–º–µ—â–µ–Ω–∏–µ –≤ –¥–Ω—è—Ö –æ—Ç —Å–µ–≥–æ–¥–Ω—è

### 2. –í—Ö–æ–¥—è—â–∏–µ (Inbox)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏ –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (ContextID = nil)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å—É
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ 10 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á —Å –¥–µ–¥–ª–∞–π–Ω–∞–º–∏
- Callback: `menu_inbox`

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
–ü—Ä–æ—Ü–µ—Å—Å –∏–∑ 4 —à–∞–≥–æ–≤:
1. **–ù–∞–∑–≤–∞–Ω–∏–µ** - –≤–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
2. **–û–ø–∏—Å–∞–Ω–∏–µ** - –≤–≤–æ–¥ –æ–ø–∏—Å–∞–Ω–∏—è (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ "-")
3. **–ö–æ–Ω—Ç–µ–∫—Å—Ç** - –≤—ã–±–æ—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ –Ω–æ–º–µ—Ä—É (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ "-")
4. **–î–µ–¥–ª–∞–π–Ω** - –±—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä –¥–∞—Ç—ã:
   - –°–µ–≥–æ–¥–Ω—è (0 –¥–Ω–µ–π)
   - –ó–∞–≤—Ç—Ä–∞ (+1 –¥–µ–Ω—å)
   - –ü–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞ (+2 –¥–Ω—è)
   - –ß–µ—Ä–µ–∑ 3 –¥–Ω—è
   - –ß–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é (+7 –¥–Ω–µ–π)
   - –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å (–±–µ–∑ –¥–µ–¥–ª–∞–π–Ω–∞)

Callback –¥–ª—è –¥–∞—Ç: `date_{days}` –∏–ª–∏ `date_skip`

### 4. –ü–æ–∏—Å–∫
- –ò—â–µ—Ç –∫–∞–∫ –ø–æ –∑–∞–¥–∞—á–∞–º, —Ç–∞–∫ –∏ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è:
  - –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã (–¥–æ 5)
  - –ó–∞–¥–∞—á–∏ (–¥–æ 10)
- –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "üîç –ü–æ–∏—Å–∫" —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ `searching`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ
- `/start` - –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/menu` - –ø–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/help` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º

### –ó–∞–¥–∞—á–∏
- `/today` - –∑–∞–¥–∞—á–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è (–∞–Ω–∞–ª–æ–≥ –∫–Ω–æ–ø–∫–∏ "–°–µ–≥–æ–¥–Ω—è")
- `/tasks` - –≤—Å–µ –∑–∞–¥–∞—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/newtask` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
- `/search <–∑–∞–ø—Ä–æ—Å>` - –ø–æ–∏—Å–∫ –ø–æ –∑–∞–¥–∞—á–∞–º –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º

### –ö–æ–Ω—Ç–µ–∫—Å—Ç—ã
- `/contexts` - –≤—Å–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/newcontext` - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

### –°–ª—É–∂–µ–±–Ω—ã–µ
- `/cancel` - –æ—Ç–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é

## –°–æ—Å—Ç–æ—è–Ω–∏—è FSM

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ–Ω–µ—á–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞–º–∏:

1. **creating_task** - –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ (4 —à–∞–≥–∞)
2. **creating_context** - –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (2 —à–∞–≥–∞)
3. **editing_task** - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (TODO)
4. **searching** - –æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

## Callback handlers

### menu_*
- `menu_main` - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `menu_today` - —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–µ –∑–∞–¥–∞—á–∏
- `menu_tasks` - –≤—Å–µ –∑–∞–¥–∞—á–∏
- `menu_newtask` - —Å–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
- `menu_contexts` - –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã
- `menu_newcontext` - —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
- `menu_search` - –ø–µ—Ä–µ—Ö–æ–¥ –≤ —Ä–µ–∂–∏–º –ø–æ–∏—Å–∫–∞
- `menu_inbox` - –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–¥–∞—á–∏
- `menu_schedule_{N}` - —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ —Å–º–µ—â–µ–Ω–∏–µ–º N –¥–Ω–µ–π

### task_*
- `task_complete_{id}` - –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É
- `task_view_{id}` - –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–¥–∞—á–∏
- `task_edit_{id}` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É
- `task_delete_{id}` - —É–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É
- `task_confirm_{id}` - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ

### context_*
- `context_view_{id}` - –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- `context_edit_{id}` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
- `context_delete_{id}` - —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
- `context_confirm_{id}` - –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ
- `context_cancel` - –æ—Ç–º–µ–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ

### date_*
- `date_{N}` - –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É —á–µ—Ä–µ–∑ N –¥–Ω–µ–π
- `date_skip` - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –¥–µ–¥–ª–∞–π–Ω–∞

## –§–∞–π–ª—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- `bot_handler.go` - –æ—Å–Ω–æ–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏–π
- `bot_commands.go` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π FSM
- `bot_callbacks.go` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback –æ—Ç –∫–Ω–æ–ø–æ–∫
- `bot_keyboards.go` - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä (–º–µ–Ω—é, –Ω–∞–≤–∏–≥–∞—Ü–∏—è, –≤—ã–±–æ—Ä)
